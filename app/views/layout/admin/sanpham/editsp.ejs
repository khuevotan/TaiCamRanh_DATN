<title>Chỉnh Sửa Sản Phẩm</title>

<div class="page-content fade-in-up">
    <div class="row">
        <div class="col-md-7">
            <% if (typeof status !== 'undefined') { %>
                <%if (status == 'success') { %>

                <div class="ibox ibox-success">
                    <div class="ibox-head">
                        <div class="ibox-title">
                     
                            <div style="color: rgb(255, 255, 255);">
                                Cập Nhật Thành Công!
                            </div>
                        </div>
                        <div class="ibox-tools">
                            <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                            <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                        </div>

                <% } else { %>
                    <%if (status == 'error') { %>
                <div class=" ibox ibox-danger">
                    <div class="ibox-head">
                            <div class="ibox-title">
                              
                                    <div style="color: rgb(255, 255, 255);">
                                        Đã xảy ra lỗi khi cập nhật Sản Phẩm!
                                    </div>
                            </div>
                            <div class="ibox-tools">
                                    <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                                    <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                            </div>
                        <% } else { %>
                            <div class="ibox ibox-info">
                                <div class="ibox-head">
                                    <div class="ibox-title">
                                      
                                        <div style="color: rgb(255, 255, 255);">
                                          
                                        </div>
                                    </div>
                                    <div class="ibox-tools">
                                        <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                                        <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                                    </div>
                            <% } %>
                <% } %>
            <% } else { %>
            <div class="ibox ibox-info">
                <div class="ibox-head">
                    <div class="ibox-title">
                      
                        <div style="color: rgb(255, 255, 255);">
                            Chỉnh Sửa Thông Tin
                        </div>
                    </div>
                    <div class="ibox-tools">
                        <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                        <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                    </div>
            <% } %>
                </div>

                <div class="ibox-body">
                    <form action="/admin/sanpham/<%= sanpham.masp %>" class="form-horizontal"
                        id="form-sample-1" method="post" novalidate="novalidate"
                        onSubmit="return confirm('Bạn có chắc chắn muốn thay đổi thông tin?') "
                        >
                        <input type="hidden" name="_method" value="put" />

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Mã Sản Phẩm</label>
                            <div class="col-sm-10">
                                <input class="form-control" type="text" name="masp"
                                    value="<%= sanpham.masp %>" readonly>
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Tên Sản Phẩm</label>
                            <div class="col-sm-10">
                                <input class="form-control" type="text" name="tensp"
                                    value="<%= sanpham.tensp %>">
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Mô Tả Chi Tiết</label>
                            <div class="col-sm-10">
                                <textarea class="form-control" rows="6"
                                    name="motact"><%= danhmuc.motact %></textarea>
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Mô Tả Ngắn</label>
                            <div class="col-sm-10">
                               
                                    <textarea class="form-control" rows="6"
                                    name="motangan"><%= sanpham.motangan %></textarea>
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Số Lượng</label>
                            <div class="col-sm-10">
                                <input class="form-control" type="text" name="soluong"
                                    value="<%= sanpham.soluong %>">
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Giá Bán</label>
                            <div class="col-sm-10">
                                <input class="form-control number-input" type="text" name="giaban"
                                    value="<%= sanpham.giaban %>">
                            </div>
                        </div>



                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Tên Danh Mục</label>
                            <div class="col-sm-10">     
                                    <select class="form-control" name="madm">
                                        <% for(var i=0; i < danhmuc.length; i++) { %>
                                            <% if(danhmuc[i].madm == sanpham.madm){ %>
                                                <option name="madm" selected value="<%= danhmuc[i].madm %>"> <%= danhmuc[i].tendm %></option>
                                                <% } else{ %>  
                                                    <option value="<%= danhmuc[i].madm %>"> <%= danhmuc[i].tendm %></option>
                                               <% } %>
                                         <%} %>
                                    </select>
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Nhà Cung Cấp</label>
                            <div class="col-sm-10">     
                                    <select class="form-control" name="mancc">
                                        <% for(var i=0; i < nhacungcap.length; i++) { %>
                                            <% if(nhacungcap[i].mancc == sanpham.mancc){ %>
                                                <option name="mancc" selected value="<%= nhacungcap[i].mancc %>"> <%= nhacungcap[i].tenncc %></option>
                                                <% } else{ %>  
                                                    <option value="<%= nhacungcap[i].mancc %>"> <%= nhacungcap[i].tenncc %></option>
                                               <% } %>
                                         <%} %>
                                    </select>
                            </div>
                        </div>
                      
                      
                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Mô Tả Chi Tiết</label>
                            <div class="col-sm-10">
                              

                                    <textarea id="summernote" data-plugin="summernote" data-air-mode="true" name="motact">
                                        <%= sanpham.motact %>
                                    </textarea>
                            </div>
                        </div>

                     
                        <div class="form-group row">
                            <div class="col-sm-10 ml-sm-auto">
                                <button class="btn btn-info btn-rounded " type="submit">Cập Nhật</button>
                                <a href="/admin/sanpham/details/<%= sanpham.masp %>" class="btn btn-info btn-rounded">Xem Chi Tiết</a>
                            </div>
                        </div>
                    </form>
                </div>
            </div> 
        </div>

        <div class="col-md-5">
            <% if (typeof status !== 'undefined') { %>
                <%if (status == 'successhdd') { %>
                    <div class="ibox ibox-success">
                        <div class="ibox-head">
                            <div class="ibox-title">
                                <div style="color: rgb(255, 255, 255);">
                                    Cập Nhật Thành Công!
                                </div>
                            </div>
                            <div class="ibox-tools">
                                <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                                <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                            </div>

                <% } else { %>

                    <%if (status == 'errorhdd') { %>

                    <div class=" ibox ibox-danger">
                        <div class="ibox-head">
                                <div class="ibox-title">
                                       
                                        <div style="color: rgb(255, 255, 255);">
                                            Đã xảy ra lỗi khi cập nhật ảnh đại diện!
                                        </div>
                                </div>
                                <div class="ibox-tools">
                                        <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                                        <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                                </div>
                                <% } else { %>
                                    <div class="ibox ibox-info">
                                        <div class="ibox-head">
                                            <div class="ibox-title">
                                                <div style="color: rgb(255, 255, 255);">
                                                Đổi Ảnh Đại Diện
                                                </div>
                                            </div>
                                            <div class="ibox-tools">
                                                <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                                                <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                                            </div>
                                <% } %>
                <% } %>
            <% } else { %>
                <div class="ibox ibox-info">
                    <div class="ibox-head">
                        <div class="ibox-title">
                            <div style="color: rgb(255, 255, 255);">
                            Đổi Ảnh Đại Diện
                            </div>
                        </div>
                        <div class="ibox-tools">
                            <a class="ibox-collapse"><i class="fa fa-minus"></i></a>
                            <a class="fullscreen-link"><i class="fa fa-expand"></i></a>
                        </div>
            <% } %>
                </div>
                <div class="ibox-body">
                    <form action="/admin/sanpham/anhdaidien/<%= sanpham.masp %>" 
                        class="form-horizontal" enctype="multipart/form-data" 
                        method="POST"
                        onSubmit="return confirm('Bạn có chắc chắn muốn đổi?') "
                        
                        > 
                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Hình Cũ</label>
                            <div class="col-sm-10">
                                <input class="form-control" type="text" name="hinhdd"
                                    value="<%= sanpham.hinhdd %>" readonly />
                                    </br>
                                <img src="/images/sanpham/<%= sanpham.hinhdd %>" width="200px" />
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Đổi Ảnh Mới</label>
                            <div class="col-sm-10">
                                <input type="file" name="hinhddmoi" accept="image/*" required/>
                            </div>
                        </div>
                      
                        <input class="btn btn-info btn-rounded " type="submit" value="Đổi Ảnh Đại Diện"/>
                      
                     </form>
                </div>
            </div>
        </div>

    </div>
</div>


<!-- Sử dụng cho jquery - validation -->
<script src="/assets/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script>
<script src="/assets/vendors/jquery-validation/dist/jquery.validate.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $("#form-sample-1").validate({
        rules: {
            tensp: {
                rangelength: [2, 255],
                required: !0
            },
            motact: {
                required: !0,
                rangelength: [2, 5000],
            },
            hinhdd: {
                required: !0,
            },
            soluong: {
                number: true,
                rangelength: [1, 9],
                required: !0
            },
            giaban: {
                number: true,
                rangelength: [1, 11],
                required: !0
            },
            madm: {
                required: !0
            },
            mancc: {
                required: !0
            },
        },
        errorClass: "help-block error",
        highlight: function(e) {
            $(e).closest(".form-group.row").addClass("has-error")
        },
        unhighlight: function(e) {
            $(e).closest(".form-group.row").removeClass("has-error")
        },
    });
</script>


<script type="text/javascript">
    $(function () {
        $('#summernote').summernote();
        $('#summernote_air').summernote({
            airMode: true
        });
    });

    const inputs = document.querySelectorAll('.number-input');

    inputs.forEach(input => {
        input.addEventListener('input', function() {
            let value = parseInt(this.value.replace(/\D/g, ''));
            if (value) {
            this.value = value.toLocaleString('en-US');
            }
        });
    });
</script>